program: train_ctm.py
method: random
metric:
  name: val_dice_score
  goal: maximize

parameters:
  lr:
    distribution: log_uniform_values
    min: 1e-5
    max: 5e-4
  alpha:
    distribution: uniform
    min: 0.5
    max: 4.0
  lambda_cycle:
    distribution: uniform
    min: 0.5
    max: 2.0
  lambda_expansion:
    distribution: uniform
    min: -0.8
    max: -0.1

command:
  - ${env}           # Environment variables
  - torchrun         
  - --nproc_per_node=4
  - ${program}       # Calls 'train_ctm.py'
  - ${args}          # Passes the swept parameters
  
  - --data_dir
  - "/mnt/hot/public/Akul/exhale_pred_data_10pct"
  - --save_dir
  - "wandb_save" 
  - --epochs
  - "50"
  - --batch_size
  - "3"
  - --n_workers
  - "8"
  - --val_interval
  - "1"
  - --dataset_fraction
  - "1"